"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[957],{3957:function(e,r,n){n.r(r),n.d(r,{default:function(){return A}});var a,t=n(4165),s=n(5861),i=n(9439),c=n(1413),d=n(2791),o=n(3263),l=n(1299),u=n(9743),h=n(2677),p=n(9140),x=n(1398),Z=n(6907),j=n(1087),m=n(7689),f=n(168),v=n(6444).ZP.img(a||(a=(0,f.Z)(["\n  max-width: 100px;\n"]))),y=n(2597),g=n(2619),P=n(4193),E=n(9085),b=n(184),_=function(e,r){switch(r.type){case"FETCH_REQUEST":return(0,c.Z)((0,c.Z)({},e),{},{loading:!0,error:""});case"FETCH_SUCCESS":return(0,c.Z)((0,c.Z)({},e),{},{loading:!1,order:r.payload,error:""});case"FETCH_FAIL":return(0,c.Z)((0,c.Z)({},e),{},{loading:!0,error:r.payload});case"PAY_REQUEST":return(0,c.Z)((0,c.Z)({},e),{},{loadingPay:!0});case"PAY_SUCCESS":return(0,c.Z)((0,c.Z)({},e),{},{loadingPay:!1,successPay:!0});case"PAY_FAIL":return(0,c.Z)((0,c.Z)({},e),{},{loadingPay:!1,errorPay:r.payload});case"PAY_RESET":return(0,c.Z)((0,c.Z)({},e),{},{loadingPay:!1,successPay:!1});default:return(0,c.Z)({},e)}},A=function(){var e=(0,m.s0)(),r=(0,d.useReducer)(_,{loading:!0,order:{},error:"",successPay:!1,loadingPay:!1}),n=(0,i.Z)(r,2),a=n[0],c=a.loading,f=a.error,A=a.order,C=a.successPay,S=a.loadingPay,T=n[1],I=(0,m.UO)().id,N=(0,d.useContext)(g.y).state.userInfo,k=(0,l.Up)(),R=(0,i.Z)(k,2),F=R[0].isPending,w=R[1];return(0,d.useEffect)((function(){var r=function(){var e=(0,s.Z)((0,t.Z)().mark((function e(){var r,n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,T({type:"FETCH_REQUEST"}),e.next=4,o.Z.get("http://localhost:3001/api/orders/".concat(I),{headers:{authorization:"Bearer ".concat(N.token)}});case 4:r=e.sent,n=r.data,T({type:"FETCH_SUCCESS",payload:n}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),T({type:"FETCH_FAIL",payload:(0,P.b)(e.t0)});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();if(!N)return e("/login");if(!A._id||A._id&&A._id!==I)r(),C&&T({type:"PAY_RESET"});else{var n=function(){var e=(0,s.Z)((0,t.Z)().mark((function e(){var r,n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.get("http://localhost:3001/api/keys/paypal",{headers:{authorization:"Bearer ".concat(N.token)}});case 2:r=e.sent,n=r.data,w({type:"resetOptions",value:{"client-id":n,currency:"BRL"}}),w({type:"setLoadingStatus",value:l.$b.PENDING});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n()}}),[A,e,N,I,C]),c?(0,b.jsx)(y.pH,{}):f?(0,b.jsx)(y._p,{variant:"danger",children:f}):(0,b.jsxs)("div",{children:[(0,b.jsx)(Z.ql,{children:(0,b.jsxs)("title",{children:["Pedido ",I," "]})}),(0,b.jsxs)("h1",{className:"my-3",children:["Pedido: ",I]}),(0,b.jsxs)(u.Z,{children:[(0,b.jsxs)(h.Z,{md:8,children:[(0,b.jsx)(p.Z,{className:"mb-3",children:(0,b.jsxs)(p.Z.Body,{children:[(0,b.jsx)(p.Z.Title,{children:"Entrega"}),(0,b.jsxs)(p.Z.Text,{children:[(0,b.jsx)("strong",{children:"Nome:"})," ",A.shippingAddress.fullName," ",(0,b.jsx)("br",{}),(0,b.jsx)("strong",{children:"Endere\xe7o:"})," ",A.shippingAddress.address,",",A.shippingAddress.city,", ",A.shippingAddress.postalCode,", ",A.shippingAddress.country]}),A.isDelivered?(0,b.jsxs)(y._p,{children:["Enviado: ",A.deliveredAt]}):(0,b.jsx)(y._p,{variant:"danger",children:"N\xe3o enviado"})]})}),(0,b.jsx)(p.Z,{className:"mb-3",children:(0,b.jsxs)(p.Z.Body,{children:[(0,b.jsx)(p.Z.Title,{children:"Pagamento"}),(0,b.jsx)(p.Z.Text,{children:(0,b.jsxs)("strong",{children:["M\xe9todo: ",A.payamentMethod]})}),A.isPaid?(0,b.jsxs)(y._p,{children:["Pagamento efetuado: ",A.paidAt]}):(0,b.jsx)(y._p,{variant:"danger",children:"Pagamento n\xe3o efetuado"})]})}),(0,b.jsx)(p.Z,{className:"mb-3",children:(0,b.jsxs)(p.Z.Body,{children:[(0,b.jsx)(p.Z.Title,{children:"Items"}),(0,b.jsx)(x.Z,{variant:"flush",children:A.orderItems.map((function(e){return(0,b.jsx)(x.Z.Item,{children:(0,b.jsxs)(u.Z,{className:"align-items-center",children:[(0,b.jsxs)(h.Z,{md:6,children:[(0,b.jsx)(v,{src:e.image,alt:e.name,className:"img-fluid rounded img-thumbnail"})," "," ",(0,b.jsx)(j.Link,{to:"/product".concat(e.slug),children:e.name})]}),(0,b.jsx)(h.Z,{md:3,children:e.quantity}),(0,b.jsxs)(h.Z,{md:3,children:["R$",e.price]})]})},e._id)}))})]})})]}),(0,b.jsx)(h.Z,{md:4,children:(0,b.jsx)(p.Z,{children:(0,b.jsxs)(p.Z.Body,{children:[(0,b.jsx)(p.Z.Title,{children:"Resumo do pedido"}),(0,b.jsxs)(x.Z,{variant:"flush",children:[(0,b.jsx)(x.Z.Item,{children:(0,b.jsxs)(u.Z,{children:[(0,b.jsx)(h.Z,{children:"Items"}),(0,b.jsxs)(h.Z,{children:["R$",A.itemsPrice.toFixed(2)]})]})}),(0,b.jsx)(x.Z.Item,{children:(0,b.jsxs)(u.Z,{children:[(0,b.jsx)(h.Z,{children:"Entrega"}),(0,b.jsxs)(h.Z,{children:["R$",A.shippingPrice.toFixed(2)]})]})}),(0,b.jsx)(x.Z.Item,{children:(0,b.jsxs)(u.Z,{children:[(0,b.jsx)(h.Z,{children:"Taxas"}),(0,b.jsxs)(h.Z,{children:["R$",A.taxPrice.toFixed(2)]})]})}),(0,b.jsx)(x.Z.Item,{children:(0,b.jsxs)(u.Z,{children:[(0,b.jsx)(h.Z,{children:(0,b.jsx)("strong",{children:"Pedido Total"})}),(0,b.jsx)(h.Z,{children:(0,b.jsxs)("strong",{children:["R$",A.totalPrice.toFixed(2)]})})]})}),!A.isPaid&&(0,b.jsxs)(x.Z.Item,{children:[F?(0,b.jsx)(y.pH,{}):(0,b.jsx)("div",{children:(0,b.jsx)(l.ch,{createOrder:function(e,r){return r.order.create({purchase_units:[{amount:{value:A.totalPrice}}]}).then((function(e){return e}))},onApprove:function(e,r){return r.order.capture().then(function(){var e=(0,s.Z)((0,t.Z)().mark((function e(r){var n,a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{T({type:"PAY_REQUEST"}),n=o.Z.put("http://localhost:3001/api/orders/".concat(A._id,"/pay"),{details:r},{headers:{authorization:"Bearer ".concat(N.token)}}),a=n.data,T({type:"PAY_SUCCESS",payload:a}),E.Am.success("Pedido foi pago")}catch(t){T({type:"PAY_FAIL",payload:(0,P.b)(t)}),E.Am.error((0,P.b)(t))}case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())},onError:function(e){E.Am.error((0,P.b)(e))}})}),S&&(0,b.jsx)(y.pH,{})]})]})]})})})]})]})}},1398:function(e,r,n){n.d(r,{Z:function(){return g}});var a=n(1413),t=n(5987),s=n(1694),i=n.n(s),c=n(2791),d=(n(2391),n(8580)),o=n(1337),l=n(162),u=n(9439),h=n(9007),p=n(4787),x=n(8633),Z=n(184),j=["bsPrefix","active","disabled","eventKey","className","variant","action","as"],m=c.forwardRef((function(e,r){var n=e.bsPrefix,s=e.active,c=e.disabled,d=e.eventKey,o=e.className,m=e.variant,f=e.action,v=e.as,y=(0,t.Z)(e,j);n=(0,l.vE)(n,"list-group-item");var g=(0,p.v)((0,a.Z)({key:(0,x.h)(d,y.href),active:s},y)),P=(0,u.Z)(g,2),E=P[0],b=P[1],_=(0,h.Z)((function(e){if(c)return e.preventDefault(),void e.stopPropagation();E.onClick(e)}));c&&void 0===y.tabIndex&&(y.tabIndex=-1,y["aria-disabled"]=!0);var A=v||(f?y.href?"a":"button":"div");return(0,Z.jsx)(A,(0,a.Z)((0,a.Z)((0,a.Z)({ref:r},y),E),{},{onClick:_,className:i()(o,n,b.isActive&&"active",c&&"disabled",m&&"".concat(n,"-").concat(m),f&&"".concat(n,"-action"))}))}));m.displayName="ListGroupItem";var f=m,v=["className","bsPrefix","variant","horizontal","numbered","as"],y=c.forwardRef((function(e,r){var n,s=(0,d.Ch)(e,{activeKey:"onSelect"}),c=s.className,u=s.bsPrefix,h=s.variant,p=s.horizontal,x=s.numbered,j=s.as,m=void 0===j?"div":j,f=(0,t.Z)(s,v),y=(0,l.vE)(u,"list-group");return p&&(n=!0===p?"horizontal":"horizontal-".concat(p)),(0,Z.jsx)(o.Z,(0,a.Z)((0,a.Z)({ref:r},f),{},{as:m,className:i()(c,y,h&&"".concat(y,"-").concat(h),n&&"".concat(y,"-").concat(n),x&&"".concat(y,"-numbered"))}))}));y.displayName="ListGroup";var g=Object.assign(y,{Item:f})}}]);
//# sourceMappingURL=957.08b7c600.chunk.js.map