{"version":3,"file":"static/js/546.ba709fd8.chunk.js","mappings":"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","sources":["screens/SearchScreen/index.tsx"],"sourcesContent":["import React, { useReducer, useEffect, useState } from 'react'\r\nimport axios from 'axios'\r\nimport { useLocation, useNavigate } from 'react-router-dom'\r\nimport { getError } from '../../util/utils'\r\nimport { toast } from 'react-toastify'\r\nimport { Helmet } from 'react-helmet-async'\r\nimport { Button, Col, Row } from 'react-bootstrap'\r\nimport { Link } from 'react-router-dom'\r\nimport { LoadingBox, MessageBox, Product, Rating } from '../../components'\r\nimport { LinkContainer } from 'react-router-bootstrap'\r\n\r\nconst reducer = (state: any, action: any) => {\r\n  switch (action.type) {\r\n    case 'FETCH_REQUEST':\r\n      return {\r\n        ...state,\r\n        loading: true\r\n      }\r\n    case 'FETCH_SUCCESS':\r\n      return {\r\n        ...state,\r\n        loading: false, \r\n        products: action.payload.products,\r\n        page: action.payload.page,\r\n        pages: action.payload.pages,\r\n        countProducts: action.payload.countProducts\r\n      }\r\n    case 'FETCH_FAIL':\r\n        return {\r\n          ...state,\r\n          loading: false,\r\n          error: action.payload\r\n        }\r\n    default: \r\n      return state\r\n  }\r\n}\r\n\r\nexport const prices = [\r\n  { \r\n    name: 'R$ 1 A R$ 50',\r\n    value: '1-50'\r\n  },\r\n  { \r\n    name: 'R$ 51 A R$ 200',\r\n    value: '51-200'\r\n  },\r\n  { \r\n    name: 'R$ 201 A R$ 1000',\r\n    value: '201-1000'\r\n  },\r\n];\r\n\r\nexport const ratings = [\r\n  { \r\n    name: '4 estrelas & acima',\r\n    rating: 4\r\n  },\r\n  { \r\n    name: '3 estrelas & acima',\r\n    rating: 3\r\n  },\r\n  { \r\n    name: '2 estrelas & acima',\r\n    rating: 2\r\n  },\r\n  { \r\n    name: '1 estrelas & acima',\r\n    rating: 1\r\n  },\r\n];\r\n\r\nconst SearchScreen = () => {\r\n  const navigate = useNavigate();\r\n  const { search } = useLocation();\r\n  const sp = new URLSearchParams(search); //search ? category = 'Shirts'\r\n\r\n  const category = sp.get('category') || 'all';\r\n  const query = sp.get('query') || 'all';\r\n  const price = sp.get('price') || 'all';\r\n  const rating = sp.get('rating') || 'all';\r\n  const order = sp.get('order') || 'all';\r\n  const page = sp.get('page') || 1;\r\n\r\n  const [{ loading, error, products, pages, countProducts }, dispatch] = useReducer(reducer, {\r\n    loading: false,\r\n    error: ''\r\n  });\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const { data }: any = await axios.get(\r\n          `http://localhost:3001/api/products/search?page=${page}&query=${query}&category=${category}&price=${price}&rating=${rating}&order=${order}`\r\n        );\r\n        dispatch({ type: 'FETCH_SUCCESS',payload: data });\r\n      } catch (error) {\r\n        dispatch({ type: 'FETCH_FAIL', payload: getError(error) })\r\n      }\r\n    }\r\n    fetchData();\r\n  },[category, error, order, page, query, price, rating]);\r\n\r\n  const [categories, setCategories] = useState([]);\r\n  useEffect(() => {\r\n    const fetchCategories = async () => {\r\n      try {\r\n        const { data }: any = await axios.get('http://localhost:3001/api/products/categories');\r\n        setCategories(data);\r\n      } catch (error) {\r\n        toast.error(getError(error));\r\n      }\r\n    };\r\n\r\n    fetchCategories();\r\n  },[]);\r\n\r\n  const getFilterUrl = (filter: any, skipPathname: boolean = false) => {\r\n    const filterPage = filter.page || page;\r\n    const filterCategory = filter.category || category;\r\n    const filterQuery = filter.query || query;\r\n    const filterRating = filter.rating || rating;\r\n    const filterPrice = filter.price || price;\r\n    const sortOrder = filter.order || order;\r\n    return `${\r\n      skipPathname ? '' : '/search?'\r\n    }category=${filterCategory}&query=${filterQuery}&price=${filterPrice}&rating=${filterRating}&order=${sortOrder}&page=${filterPage}`;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Helmet>\r\n        <title>Procurar produtos</title>\r\n      </Helmet>\r\n      <Row>\r\n        <Col md={3}>\r\n          <h3>Departamento</h3>\r\n          <div>\r\n            <ul>\r\n              <li>\r\n                <Link \r\n                  className={\r\n                    'all' === category \r\n                    ? 'text-bold' \r\n                    : ''\r\n                  } \r\n                  to={getFilterUrl({ category: 'all' })}\r\n                >\r\n                  Any  \r\n                </Link>\r\n              </li>\r\n              {categories.map((c) => (\r\n                <li key={c}>\r\n                  <Link\r\n                    className={\r\n                      c === 'category' \r\n                      ? 'text-bold' \r\n                      : ''\r\n                    }\r\n                    to={getFilterUrl({ category: c })}\r\n                  >\r\n                    { c }\r\n                  </Link>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n          <div>\r\n            <h3>Preço</h3>\r\n            <ul>\r\n              <li>\r\n              <Link\r\n                  className={\r\n                    'all' === price \r\n                    ? 'text-bold' \r\n                    : ''\r\n                  }\r\n                  to={getFilterUrl({ price: 'all' })}\r\n                >\r\n                  Any\r\n                </Link>\r\n              </li>\r\n              {prices.map((p) => (\r\n                <li key={p.value}>\r\n                  <Link\r\n                    className={\r\n                      p.value === price \r\n                      ? 'text-bold' \r\n                      : ''\r\n                    }\r\n                    to={getFilterUrl({ price: p.value })}\r\n                  >\r\n                    { p.name }\r\n                  </Link>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n          <div>\r\n            <h3>Avg. Customer Review</h3>\r\n            <ul>\r\n              {ratings\r\n              .map((r) => (\r\n                <li key={r.name}>\r\n                  <Link\r\n                    className={\r\n                      `${r.rating}` === `${rating}` \r\n                      ? 'text-bold' \r\n                      : ''\r\n                    }\r\n                    to={getFilterUrl({ rating: r.rating })}\r\n                  >\r\n                    <Rating caption={' & up'} rating={r.rating}></Rating>\r\n                  </Link>\r\n                </li>\r\n              ))}\r\n              <li>\r\n                <Link\r\n                  className={\r\n                    rating === \"all\" \r\n                    ? 'text-bold' \r\n                    : ''\r\n                  }\r\n                  to={getFilterUrl({ rating: \"all\" })}\r\n                >\r\n                  <Rating caption={' & up'} rating={0}></Rating>\r\n                </Link>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </Col>\r\n        <Col md={9}>\r\n          {loading ? (\r\n            <LoadingBox />\r\n          ) : error ? (\r\n            <MessageBox variant='danger'>\r\n              { error }\r\n            </MessageBox>\r\n          ) : (\r\n            <>\r\n              <Row className=\"justify-content-between mb-3\">\r\n                <Col md={6}>\r\n                  <div>\r\n                    {countProducts === 0 ? 'Nenhum' : countProducts} Resultados\r\n                    {query !== 'all' && ' : ' + query}\r\n                    {category !== 'all' && ' : ' + category}\r\n                    {price !== 'all' && ' : Preço ' + price}\r\n                    {rating !== 'all' && ' : Avaliação ' + rating + ' & acima'}\r\n                    {\r\n                      query !== 'all' ||\r\n                      category !== 'all' ||\r\n                      rating !== 'all' ||\r\n                      price !== 'all' ? (\r\n                        <Button\r\n                          variant=\"light\"\r\n                          onClick={() => navigate('/search')}\r\n                        >\r\n                          <i className='fas fa-times circle'></i>\r\n                        </Button>\r\n                      ) : null\r\n                    }\r\n                  </div>\r\n                </Col>\r\n                <Col className='text-end'>\r\n                  Ordenado por{' '}\r\n                  <select \r\n                    value={order} \r\n                    onChange={(event: any) => {\r\n                      navigate(getFilterUrl(\r\n                        { order: event.target.value }\r\n                      )\r\n                    )}}\r\n                  >\r\n                    <option value=\"newest\">Newest Arrivals</option>\r\n                    <option value=\"lowest\">Price: Low to High</option>\r\n                    <option value=\"highest\">Price: High to Low</option>\r\n                    <option value=\"toprated\">Avg. Customer Reviews</option>\r\n                  </select>\r\n                </Col>\r\n                {products?.length === 0 && (\r\n                  <MessageBox>Nenhum produto encontrado</MessageBox>\r\n                )}\r\n                <Row>\r\n                  {products?.map((product: any) => (\r\n                    <Col \r\n                      key={product._id}\r\n                      md={6} \r\n                      lg={4} \r\n                      className=\"mb-3\" \r\n                    >\r\n                      <Product product={product}/>\r\n                    </Col>\r\n                  ))}\r\n                </Row>\r\n                <div>\r\n                  {[...Array(pages).keys()].map((x) => (\r\n                    <LinkContainer\r\n                      key={x + 1}\r\n                      className=\"mx-1\"\r\n                      to={{\r\n                        pathname: '/search',\r\n                        search: getFilterUrl({ page: x + 1 }, true),\r\n                      }}\r\n                    >\r\n                      <Button \r\n                        variant=\"light\" \r\n                        className={\r\n                          Number(page) === x + 1 \r\n                          ? 'text-bold' \r\n                          : ''\r\n                        }\r\n                      >\r\n                        { x + 1}\r\n                      </Button>\r\n                    </LinkContainer>\r\n                  ))}\r\n                </div>\r\n\r\n              </Row>\r\n            </>\r\n          )}\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default SearchScreen"],"names":["reducer","state","action","type","loading","products","payload","page","pages","countProducts","error","prices","name","value","ratings","rating","navigate","useNavigate","search","useLocation","sp","URLSearchParams","category","get","query","price","order","useReducer","dispatch","useEffect","fetchData","axios","data","getError","useState","categories","setCategories","fetchCategories","toast","getFilterUrl","filter","skipPathname","filterPage","filterCategory","filterQuery","filterRating","filterPrice","sortOrder","md","Link","className","to","map","c","p","r","caption","variant","onClick","onChange","event","target","length","product","lg","_id","Array","keys","x","pathname","Number"],"sourceRoot":""}